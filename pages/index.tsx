import React, { useEffect } from "react";
import Head from "next/head";
import GlobalStyle from "../src/styles/GlobalStyle";
import Menu from "src/components/common/Menu";
import Aos from "aos";
import "aos/dist/aos.css";
import Apresentation from "src/sections/Apresentation";
import WhoAmI from "src/sections/WhoAmI";
import WhatIDo from "src/sections/WhatIDo";
import Portfolio from "src/sections/Portfolio";
import Contact from "src/sections/Contact";
import Service from "src/models/Service";

interface HomeProps {
  services: Service[];
  whoAmI: string;
}

export default function Home(props: HomeProps) {
  useEffect(() => {
    Aos.init({ duration: 1900 });
  }, []);

  return (
    <>
      <Head>
        <title>Gustavo Monteiro</title>
        <meta name="description" content="Generated by create next app" />
      </Head>
      <GlobalStyle />
      <Menu />
      <Apresentation />
      <WhoAmI mainText={props.whoAmI} />
      <WhatIDo services={props.services} />
      {/* <Portfolio /> */}
      <Contact />
    </>
  );
}
export async function getStaticProps(): Promise<{ props: HomeProps }> {
  const token = process.env.NEXT_DATOCMS_API_TOKEN_RO;
  const resContent = await fetch("https://graphql.datocms.com/", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Accept: "application/json",
      Authorization: `Bearer ${token}`,
    },
    body: JSON.stringify({
      query: `
      {
        pageContent{
          whoAmI
        }
      
        allServices{
          title,
          description,
          id,
          icon {
            url
          }
        }
      }
      `,
    }),
  });
  const resContentJson: {
    data: {
      pageContent: {
        whoAmI: string;
      };
      allServices: Service[];
    };
  } = await resContent.json();
  const { allServices: services, pageContent } = resContentJson.data;

  return {
    props: { services, whoAmI: pageContent.whoAmI },
  };
}
